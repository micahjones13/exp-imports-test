import{r as t,c as i,h as s,H as r,g as o}from"./p-3aed6e85.js";import{c as e,a as n,o as a,b as h,f as p,d}from"./p-3aad9cd7.js";const l=class{constructor(s){t(this,s),this.ruxPopUpOpened=i(this,"ruxpopupopened",7),this.ruxPopUpClosed=i(this,"ruxpopupclosed",7),this._assignedOutsideClickEvent=!1,this.open=!1,this.placement="auto",this.disableAutoUpdate=!1,this.enableAnimationFrame=!1,this.strategy="absolute",this.closeOnSelect=!1}handleOpen(){this.open?(this.content.style.display="block",this._startPositioner(),this.ruxPopUpOpened.emit(),this._assignedOutsideClickEvent||(window.addEventListener("mousedown",this._handleOutsideClick),this._assignedOutsideClickEvent=!0)):(this.content.style.display="",this._stopPositioner(),this.ruxPopUpClosed.emit(),this._assignedOutsideClickEvent&&(window.removeEventListener("mousedown",this._handleOutsideClick),this._assignedOutsideClickEvent=!1))}async show(){return this.open||(this.open=!0),this.open}async hide(){return this.open?(this.open=!1,this.open):this.open}connectedCallback(){this._handleTriggerClick=this._handleTriggerClick.bind(this),this._handleTriggerKeyPress=this._handleTriggerKeyPress.bind(this),this._handleOutsideClick=this._handleOutsideClick.bind(this),this._setTriggerTabIndex=this._setTriggerTabIndex.bind(this),this.open&&!this._assignedOutsideClickEvent&&(window.addEventListener("mousedown",this._handleOutsideClick),this._assignedOutsideClickEvent=!0)}componentWillLoad(){this._setTriggerTabIndex()}componentDidRender(){this.open&&this._startPositioner()}async _handleTriggerClick(t){t.detail>0&&(this.open=!this.open)}async _handleTriggerKeyPress(t){"Enter"===t.key&&(this.open=!this.open)}_position(){this.open&&this.triggerSlot&&this.content&&(e(this.triggerSlot,this.content,{placement:this.placement,strategy:this.strategy,middleware:(()=>this.disableAutoUpdate?"auto"===this.placement?(this.placement="top",[a(12),d({element:this.arrowEl})]):[a(12),d({element:this.arrowEl})]:[a(12),"auto"===this.placement?h({alignment:"start"}):p(),d({element:this.arrowEl})])()}).then((({x:t,y:i,placement:s,middlewareData:r})=>{Object.assign(this.content.style,{left:`${t}px`,top:`${i}px`,position:`${this.strategy}`});const{x:o,y:e}=r.arrow,n={top:"bottom",right:"left",bottom:"top",left:"right"}[s.split("-")[0]];Object.assign(this.arrowEl.style,{left:null!=o?`${o}px`:"",top:null!=e?`${e}px`:"",right:"",bottom:"",[n]:"-6px"})})),this._setArrowPosition())}_setTriggerTabIndex(){const t=this.el.querySelector("[slot='trigger']");!t.hasAttribute("tabindex")&&t.setAttribute("tabindex","0")}_startPositioner(){this._stopPositioner(),this.open&&(this._position(),this._positionerCleanup=n(this.triggerSlot,this.content,this._position.bind(this),{animationFrame:this.enableAnimationFrame}))}async _setArrowPosition(){const t=await this._determineArrowPosition();this.arrowPosition!==t&&(this.arrowPosition=t)}async _determineArrowPosition(){if(!this.open)return;const t=await this.getTriggerRect(),i=await this.getArrowRect();return t.bottom>i.bottom&&t.top<i.top?t.right>i.right?"left":"right":t.bottom>i.bottom?"top":"bottom"}async getTriggerRect(){return this.triggerSlot.getBoundingClientRect()}async getArrowRect(){var t;return null===(t=this.arrowEl)||void 0===t?void 0:t.getBoundingClientRect()}_stopPositioner(){this._positionerCleanup&&(this._positionerCleanup(),this._positionerCleanup=void 0)}_handleOutsideClick(t){const i=t.composedPath().includes(this.contentSlot),s=t.composedPath().includes(this.triggerSlot),r=t.composedPath().includes(this.el);i||s||r||(this.open=!1)}handleSelection(){this.closeOnSelect&&(this.open=!1)}get contentSlot(){var t;return null===(t=this.content)||void 0===t?void 0:t.querySelector("slot").assignedElements({flatten:!0})[0]}get triggerSlot(){var t;return null===(t=this.trigger)||void 0===t?void 0:t.querySelector("slot").assignedElements({flatten:!0})[0]}get hasMenu(){var t;return!!(null===(t=this.content)||void 0===t?void 0:t.querySelector("slot").assignedElements({flatten:!0}).filter((t=>"rux-menu"===t.tagName.toLowerCase()))[0])}render(){return s(r,null,s("div",{class:"rux-popup",part:"container"},s("div",{onClick:this._handleTriggerClick,onKeyPress:this._handleTriggerKeyPress,class:"rux-popup__trigger",ref:t=>this.trigger=t,part:"trigger-container"},s("slot",{name:"trigger"})),s("div",{class:{"rux-popup__arrow-left":"left"===this.arrowPosition,"rux-popup__arrow-top":"top"===this.arrowPosition,"rux-popup__arrow-right":"right"===this.arrowPosition,"rux-popup__arrow-bottom":"bottom"===this.arrowPosition,"rux-popup__content":!0,"rux-popup__content--menu":this.hasMenu,hidden:!1===this.open},"aria-hidden":this.open?"false":"true",part:"popup-content",ref:t=>this.content=t},s("div",{class:"rux-popup-arrow",ref:t=>this.arrowEl=t,part:"arrow"}),s("slot",null))))}get el(){return o(this)}static get watchers(){return{open:["handleOpen"]}}};l.style=":host{display:block;width:min-content}.hidden,:host([hidden]){display:none}.hidden{display:none !important}::slotted(*[slot=trigger]){cursor:pointer}::slotted(*[slot=trigger]:focus-visible){border-radius:var(--focus-radius);outline:var(--focus-outline);outline-offset:var(--focus-offset)}.rux-popup{font-family:var(--font-body-1-font-family);font-size:var(--font-body-1-font-size);font-weight:var(--font-body-1-font-weight);letter-spacing:var(--font-body-1-letter-spacing);line-height:var(--line-height-base);text-align:left}.rux-popup__content{position:absolute;padding:var(--spacing-0);border-radius:var(--radius-base);background:var(--color-background-base-default);border:1px solid var(--color-border-interactive-muted);transform-style:preserve-3d;z-index:100}.rux-popup__trigger{display:contents}.rux-popup__content--menu{padding:0}.rux-popup__arrow-left{border-right:2px solid var(--color-border-interactive-muted)}.rux-popup__arrow-top{border-bottom:2px solid var(--color-border-interactive-muted)}.rux-popup__arrow-right{border-left:2px solid var(--color-border-interactive-muted)}.rux-popup__arrow-bottom{border-top:2px solid var(--color-border-interactive-muted)}.rux-popup-arrow{position:absolute;background:var(--color-border-interactive-muted);width:var(--spacing-4);height:var(--spacing-4);transform:translateZ(-1px) rotate(45deg)}";export{l as rux_pop_up}